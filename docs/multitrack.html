

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multi-track Piano-roll &mdash; pypianoroll 0.5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pypianoroll 0.5.0 documentation" href="index.html"/>
        <link rel="prev" title="Single-track Piano-roll" href="track.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pypianoroll
          

          
          </a>

          
            
            
              <div class="version">
                0.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="save_load.html">Save &amp; Load</a></li>
<li class="toctree-l1"><a class="reference internal" href="parse_write.html">Parse &amp; Write</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="track.html">Single-track Piano-roll</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multi-track Piano-roll</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pypianoroll</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Multi-track Piano-roll</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multi-track-piano-roll">
<span id="multitrack"></span><h1>Multi-track Piano-roll<a class="headerlink" href="#multi-track-piano-roll" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pypianoroll.Multitrack">
<em class="property">class </em><code class="descclassname">pypianoroll.</code><code class="descname">Multitrack</code><span class="sig-paren">(</span><em>filename=None</em>, <em>tracks=None</em>, <em>tempo=120.0</em>, <em>downbeat=None</em>, <em>beat_resolution=24</em>, <em>name='unknown'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack" title="Permalink to this definition">¶</a></dt>
<dd><p>A multitrack pianoroll container that stores additional tempo and
program information along with the pianoroll matrices.</p>
<dl class="attribute">
<dt id="pypianoroll.Multitrack.tracks">
<code class="descname">tracks</code><a class="headerlink" href="#pypianoroll.Multitrack.tracks" title="Permalink to this definition">¶</a></dt>
<dd><p>list of <a class="reference internal" href="track.html#pypianoroll.Track" title="pypianoroll.Track"><code class="xref py py-class docutils literal"><span class="pre">pypianoroll.Track</span></code></a> objects – The track object list.</p>
</dd></dl>

<dl class="attribute">
<dt id="pypianoroll.Multitrack.tempo">
<code class="descname">tempo</code><a class="headerlink" href="#pypianoroll.Multitrack.tempo" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray, shape=(n_time_steps,), dtype=float</em> – An array that indicates the tempo value (in bpm) at each time step.
The length is the total number of time steps.</p>
</dd></dl>

<dl class="attribute">
<dt id="pypianoroll.Multitrack.downbeat">
<code class="descname">downbeat</code><a class="headerlink" href="#pypianoroll.Multitrack.downbeat" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray, shape=(n_time_steps,), dtype=bool</em> – An array that indicates whether the time step contains a downbeat
(i.e., the first time step of a bar). The length is the total number
of time steps.</p>
</dd></dl>

<dl class="attribute">
<dt id="pypianoroll.Multitrack.beat_resolution">
<code class="descname">beat_resolution</code><a class="headerlink" href="#pypianoroll.Multitrack.beat_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – The number of time steps used to represent a beat.</p>
</dd></dl>

<dl class="attribute">
<dt id="pypianoroll.Multitrack.name">
<code class="descname">name</code><a class="headerlink" href="#pypianoroll.Multitrack.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – The name of the multitrack pianoroll.</p>
</dd></dl>

<p>Initialize the object by one of the following ways:
- assigning values for attributes
- loading a npz file
- parsing a MIDI file</p>
<p class="rubric">Notes</p>
<p>When <cite>filename</cite> is given, the arguments <cite>tracks</cite>, <cite>tempo</cite>, <cite>downbeat</cite>
and <cite>name</cite> are ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – The file path to the npz file to be loaded or the MIDI file (.mid,
.midi, .MID, .MIDI) to be parsed.</li>
<li><strong>beat_resolution</strong> (<em>int</em>) – The number of time steps used to represent a beat. Will be assigned
to <cite>beat_resolution</cite> when <cite>filename</cite> is not provided. Defaults to
24.</li>
<li><strong>tracks</strong> (list of <a class="reference internal" href="track.html#pypianoroll.Track" title="pypianoroll.Track"><code class="xref py py-class docutils literal"><span class="pre">pypianoroll.Track</span></code></a> objects) – The track object list to be assigned to <cite>tracks</cite> when <cite>filename</cite> is
not provided.</li>
<li><strong>tempo</strong> (<em>int</em><em> or </em><em>np.ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_time_steps</em><em>,</em><em>)</em><em>, </em><em>dtype=float</em>) – An array that indicates the tempo value (in bpm) at each time step.
The length is the total number of time steps. Will be assigned to
<cite>tempo</cite> when <cite>filename</cite> is not provided.</li>
<li><strong>downbeat</strong> (<em>list</em><em> or </em><em>np.ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_time_steps</em><em>,</em><em>)</em><em>, </em><em>dtype=bool</em>) – An array that indicates whether the time step contains a downbeat
(i.e., the first time step of a bar). The length is the total number
of time steps.  Will be assigned to <cite>downbeat</cite> when <cite>filename</cite> is
not given. If a list of indices is provided, it will be viewed as
the time step indices of the down beats and converted to a numpy
array. Default is None.</li>
<li><strong>name</strong> (<em>str</em>) – The name of the multitrack pianoroll. Defaults to ‘unknown’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pypianoroll.Multitrack.append_track">
<code class="descname">append_track</code><span class="sig-paren">(</span><em>track=None</em>, <em>pianoroll=None</em>, <em>program=0</em>, <em>is_drum=False</em>, <em>name='unknown'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.append_track"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.append_track" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a multitrack.Track instance to the track list or create a new
multitrack.Track object and append it to the track list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>track</strong> (<em>pianoroll.Track</em>) – A <a class="reference internal" href="track.html#pypianoroll.Track" title="pypianoroll.Track"><code class="xref py py-class docutils literal"><span class="pre">pypianoroll.Track</span></code></a> instance to be appended to the track
list.</li>
<li><strong>pianoroll</strong> (<em>np.ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_time_steps</em><em>, </em><em>128</em><em>)</em>) – A pianoroll matrix. The first and second dimension represents time
and pitch, respectively. Available datatypes are bool, int and
float. Only effective when <cite>track</cite> is None.</li>
<li><strong>program</strong> (<em>int</em>) – A program number according to General MIDI specification [1].
Available values are 0 to 127. Defaults to 0 (Acoustic Grand Piano).
Only effective when <cite>track</cite> is None.</li>
<li><strong>is_drum</strong> (<em>bool</em>) – A boolean number that indicates whether it is a percussion track.
Defaults to False. Only effective when <cite>track</cite> is None.</li>
<li><strong>name</strong> (<em>str</em>) – The name of the track. Defaults to ‘unknown’. Only effective when
<cite>track</cite> is None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="https://www.midi.org/specifications/item/gm-level-1-sound-set">https://www.midi.org/specifications/item/gm-level-1-sound-set</a></p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.assign_constant">
<code class="descname">assign_constant</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.assign_constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.assign_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign a constant value to the nonzeros in the pianorolls of all tracks.
If a pianoroll is not binarized, its data type will be preserved. If a
pianoroll is binarized, it will be casted to the type of <cite>value</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>int</em><em> or </em><em>float</em>) – The constant value to be assigned to the nonzeros of the pianorolls.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.binarize">
<code class="descname">binarize</code><span class="sig-paren">(</span><em>threshold=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.binarize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.binarize" title="Permalink to this definition">¶</a></dt>
<dd><p>Binarize the pianorolls of all tracks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>int</em><em> or </em><em>float</em>) – Threshold to binarize the pianorolls. Defaults to zero.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.check_validity">
<code class="descname">check_validity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.check_validity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.check_validity" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an error if any invalid attribute found.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code> – If an attribute has an invalid type.</li>
<li><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> – If an attribute has an invalid value (of the correct type).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.clip">
<code class="descname">clip</code><span class="sig-paren">(</span><em>lower=0</em>, <em>upper=127</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.clip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip the pianorolls of all tracks by the given lower and upper bounds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lower</strong> (<em>int</em><em> or </em><em>float</em>) – The lower bound to clip the pianorolls. Defaults to 0.</li>
<li><strong>upper</strong> (<em>int</em><em> or </em><em>float</em>) – The upper bound to clip the pianorolls. Defaults to 127.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Return a copy of the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>copied</strong> – A copy of the object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>pypianoroll.Multitrack</cite> object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.count_downbeat">
<code class="descname">count_downbeat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.count_downbeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.count_downbeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of down beats. The return value is calculated based
solely on <cite>downbeat</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.get_active_length">
<code class="descname">get_active_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.get_active_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.get_active_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum active length (i.e., without trailing silence) among
the pianorolls of all tracks. The unit is time step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>active_length</strong> – The maximum active length (i.e., without trailing silence) among the
pianorolls of all tracks. The unit is time step.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.get_active_pitch_range">
<code class="descname">get_active_pitch_range</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.get_active_pitch_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.get_active_pitch_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the active pitch range of the pianorolls of all tracks as a tuple
(lowest, highest).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>lowest</strong> (<em>int</em>) – The lowest active pitch among the pianorolls of all tracks.</li>
<li><strong>highest</strong> (<em>int</em>) – The lowest highest pitch among the pianorolls of all tracks.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.get_downbeat_steps">
<code class="descname">get_downbeat_steps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.get_downbeat_steps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.get_downbeat_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices of time steps that contain downbeats.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>downbeat_steps</strong> – The indices of time steps that contain downbeats.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.get_empty_tracks">
<code class="descname">get_empty_tracks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.get_empty_tracks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.get_empty_tracks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices of tracks with empty pianorolls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>empty_track_indices</strong> – The indices of tracks with empty pianorolls.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.get_max_length">
<code class="descname">get_max_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.get_max_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.get_max_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum length of the pianorolls along the time axis (in
time step).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>max_length</strong> – The maximum length of the pianorolls along the time axis (in time
step).</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.get_merged_pianoroll">
<code class="descname">get_merged_pianoroll</code><span class="sig-paren">(</span><em>mode='sum'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.get_merged_pianoroll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.get_merged_pianoroll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the merged pianoroll.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mode</strong> (<em>{'sum'</em><em>, </em><em>'max'</em><em>, </em><em>'any'}</em>) – <p>A string that indicates the merging strategy to apply along the
track axis. Default to ‘sum’.</p>
<ul class="simple">
<li>In ‘sum’ mode, the merged pianoroll is the sum of all the
pianorolls. Note that for binarized pianorolls, integer summation
is performed.</li>
<li>In ‘max’ mode, for each pixel, the maximum value among all the
pianorolls is assigned to the merged pianoroll.</li>
<li>In ‘any’ mode, the value of a pixel in the merged pianoroll is
True if any of the pianorolls has nonzero value at that pixel;
False if all pianorolls are inactive (zero-valued) at that pixel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>merged</strong> – The merged pianoroll.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray, shape=(n_time_steps, 128)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.get_stacked_pianoroll">
<code class="descname">get_stacked_pianoroll</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.get_stacked_pianoroll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.get_stacked_pianoroll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a stacked multitrack pianoroll. The shape of the return array is
(n_time_steps, 128, n_tracks).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>stacked</strong> – The stacked pianoroll.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray, shape=(n_time_steps, 128, n_tracks)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.is_binarized">
<code class="descname">is_binarized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.is_binarized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.is_binarized" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the pianorolls of all tracks are already binarized.
Otherwise, return False.</p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a npz file. Supports only files previously saved by
<a class="reference internal" href="#pypianoroll.Multitrack.save" title="pypianoroll.Multitrack.save"><code class="xref py py-meth docutils literal"><span class="pre">pypianoroll.Multitrack.save()</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>Attribute values will all be overwritten.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – The name of the npz file to be loaded.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.merge_tracks">
<code class="descname">merge_tracks</code><span class="sig-paren">(</span><em>track_indices=None</em>, <em>mode='sum'</em>, <em>program=0</em>, <em>is_drum=False</em>, <em>name='merged'</em>, <em>remove_merged=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.merge_tracks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.merge_tracks" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge pianorolls of the tracks specified by <cite>track_indices</cite>. The merged
track will have program number as given by <cite>program</cite> and drum indicator
as given by <cite>is_drum</cite>. The merged track will be appended at the end of
the track list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>track_indices</strong> (<em>list</em>) – The indices of tracks to be merged. Defaults to all the tracks.</li>
<li><strong>mode</strong> (<em>{'sum'</em><em>, </em><em>'max'</em><em>, </em><em>'any'}</em>) – <p>A string that indicates the merging strategy to apply along the
track axis. Default to ‘sum’.</p>
<ul>
<li>In ‘sum’ mode, the merged pianoroll is the sum of the collected
pianorolls. Note that for binarized pianorolls, integer summation
is performed.</li>
<li>In ‘max’ mode, for each pixel, the maximum value among the
collected pianorolls is assigned to the merged pianoroll.</li>
<li>In ‘any’ mode, the value of a pixel in the merged pianoroll is
True if any of the collected pianorolls has nonzero value at that
pixel; False if all the collected pianorolls are inactive
(zero-valued) at that pixel.</li>
</ul>
</li>
<li><strong>program</strong> (<em>int</em>) – A program number according to General MIDI specification [1].
Available values are 0 to 127. Defaults to 0 (Acoustic Grand Piano).</li>
<li><strong>is_drum</strong> (<em>bool</em>) – A boolean number that indicates whether it is a percussion track.
Defaults to False.</li>
<li><strong>name</strong> (<em>str</em>) – A name to be assigned to the merged track. Defaults to ‘merged’.</li>
<li><strong>remove_merged</strong> (<em>bool</em>) – True to remove the source tracks from the track list. False to keep
them. Defaults to False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>[1] <a class="reference external" href="https://www.midi.org/specifications/item/gm-level-1-sound-set">https://www.midi.org/specifications/item/gm-level-1-sound-set</a></p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.pad">
<code class="descname">pad</code><span class="sig-paren">(</span><em>pad_length</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad the pianorolls of all tracks with zeros at the end along the time
axis.</p>
<p class="rubric">Notes</p>
<p>The resulting pianoroll lengths are not guaranteed to be the same. See
<a class="reference internal" href="#pypianoroll.Multitrack.pad_to_same" title="pypianoroll.Multitrack.pad_to_same"><code class="xref py py-meth docutils literal"><span class="pre">pypianoroll.Multitrack.pad_to_same()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pad_length</strong> (<em>int</em>) – The length to pad along the time axis with zeros.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.pad_to_multiple">
<code class="descname">pad_to_multiple</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.pad_to_multiple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.pad_to_multiple" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad the pianoroll of each track with zeros at the end along the time
axis with the minimum length that makes the resulting pianoroll length a
multiple of <cite>factor</cite>. Do nothing if the length of a pianoroll is already
a multiple of <cite>factor</cite>.</p>
<p class="rubric">Notes</p>
<p>The resulting pianoroll lengths are not guaranteed to be the same. See
<a class="reference internal" href="#pypianoroll.Multitrack.pad_to_same" title="pypianoroll.Multitrack.pad_to_same"><code class="xref py py-meth docutils literal"><span class="pre">pypianoroll.Multitrack.pad_to_same()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>factor</strong> (<em>int</em>) – The value which the length of the resulting pianorolls will be a
multiple of.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.pad_to_same">
<code class="descname">pad_to_same</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.pad_to_same"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.pad_to_same" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad shorter pianorolls with zeros at the end along the time axis to
make the resulting pianoroll lengths the same as the maximum pianoroll
length among all the tracks.</p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.parse_midi">
<code class="descname">parse_midi</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.parse_midi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.parse_midi" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a MIDI file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – The name of the MIDI file to be parsed.</li>
<li><strong>**kwargs</strong> – See <a class="reference internal" href="#pypianoroll.Multitrack.parse_pretty_midi" title="pypianoroll.Multitrack.parse_pretty_midi"><code class="xref py py-meth docutils literal"><span class="pre">pypianoroll.Multitrack.parse_pretty_midi()</span></code></a> for full
documentation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.parse_pretty_midi">
<code class="descname">parse_pretty_midi</code><span class="sig-paren">(</span><em>pm</em>, <em>mode='max'</em>, <em>algorithm='normal'</em>, <em>binarized=False</em>, <em>skip_empty_tracks=True</em>, <em>collect_onsets_only=False</em>, <em>threshold=0</em>, <em>first_beat_time=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.parse_pretty_midi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.parse_pretty_midi" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a <code class="xref py py-class docutils literal"><span class="pre">pretty_midi.PrettyMIDI</span></code> object. The data type of the
resulting pianorolls is automatically determined (int if ‘mode’ is
‘sum’, np.uint8 if <cite>mode</cite> is ‘max’ and <cite>binarized</cite> is False, bool if
<cite>mode</cite> is ‘max’ and <cite>binarized</cite> is True).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pm</strong> (<cite>pretty_midi.PrettyMIDI</cite> object) – A <code class="xref py py-class docutils literal"><span class="pre">pretty_midi.PrettyMIDI</span></code> object to be parsed.</li>
<li><strong>mode</strong> (<em>{'max'</em><em>, </em><em>'sum'}</em>) – A string that indicates the merging strategy to apply to duplicate
notes. Default to ‘max’.</li>
<li><strong>algorithm</strong> (<em>{'normal'</em><em>, </em><em>'strict'</em><em>, </em><em>'custom'}</em>) – <p>A string that indicates the method used to get the location of the
first beat. Notes before it will be dropped unless an incomplete
beat before it is found (see Notes for more information). Defaults
to ‘normal’.</p>
<ul>
<li>The ‘normal’ algorithm estimates the location of the first beat by
<code class="xref py py-meth docutils literal"><span class="pre">pretty_midi.PrettyMIDI.estimate_beat_start()</span></code>.</li>
<li>The ‘strict’ algorithm sets the first beat at the event time of
the first time signature change. Raise a ValueError if no time
signature change event is found.</li>
<li>The ‘custom’ algorithm takes argument <cite>first_beat_time</cite> as the
location of the first beat.</li>
</ul>
</li>
<li><strong>binarized</strong> (<em>bool</em>) – True to binarize the parsed pianorolls before merging duplicate
notes. False to use the original parsed pianorolls. Defaults to
False.</li>
<li><strong>skip_empty_tracks</strong> (<em>bool</em>) – True to remove tracks with empty pianorolls and compress the pitch
range of the parsed pianorolls. False to retain the empty tracks
and use the original parsed pianorolls. Deafault to True.</li>
<li><strong>collect_onsets_only</strong> (<em>bool</em>) – True to collect only the onset of the notes (i.e. note on events) in
all tracks, where the note off and duration information are dropped.
False to parse regular pianorolls.</li>
<li><strong>threshold</strong> (<em>int</em><em> or </em><em>float</em>) – A threshold used to binarize the parsed pianorolls. Only effective
when <cite>binarized</cite> is True. Defaults to zero.</li>
<li><strong>first_beat_time</strong> (<em>float</em>) – The location (in sec) of the first beat. Required and only effective
when using ‘custom’ algorithm.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If an incomplete beat before the first beat is found, an additional beat
will be added before the (estimated) beat starting time. However, notes
before the (estimated) beat starting time for more than one beat are
dropped.</p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the pianorolls or save a plot of them. See
<a class="reference internal" href="visualization.html#pypianoroll.plot.plot_multitrack" title="pypianoroll.plot.plot_multitrack"><code class="xref py py-func docutils literal"><span class="pre">pypianoroll.plot.plot_multitrack()</span></code></a> for full documentation.</p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.remove_empty_tracks">
<code class="descname">remove_empty_tracks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.remove_empty_tracks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.remove_empty_tracks" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove tracks with empty pianorolls.</p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.remove_tracks">
<code class="descname">remove_tracks</code><span class="sig-paren">(</span><em>track_indices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.remove_tracks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.remove_tracks" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove tracks specified by <cite>track_indices</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>track_indices</strong> (<em>list</em>) – The indices of the tracks to be removed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>compressed=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the multitrack pianoroll to a (compressed) npz file, which can be
later loaded by <a class="reference internal" href="#pypianoroll.Multitrack.load" title="pypianoroll.Multitrack.load"><code class="xref py py-meth docutils literal"><span class="pre">pypianoroll.Multitrack.load()</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>To reduce the file size, the pianorolls are first converted to instances
of scipy.sparse.csc_matrix, whose component arrays are then collected
and saved to a npz file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – The name of the npz file to which the mulitrack pianoroll is saved.</li>
<li><strong>compressed</strong> (<em>bool</em>) – True to save to a compressed npz file. False to save to an
uncompressed npz file. Defaults to True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.to_pretty_midi">
<code class="descname">to_pretty_midi</code><span class="sig-paren">(</span><em>constant_tempo=None</em>, <em>constant_velocity=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.to_pretty_midi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.to_pretty_midi" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to a <code class="xref py py-class docutils literal"><span class="pre">pretty_midi.PrettyMIDI</span></code> instance.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li>Only constant tempo is supported by now.</li>
<li>The velocities of the converted pianorolls are clipped to [0, 127],
i.e. values below 0 and values beyond 127 are replaced by 127 and 0,
respectively.</li>
<li>Adjacent nonzero values of the same pitch will be considered a single
note with their mean as its velocity.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>constant_tempo</strong> (<em>int</em>) – The constant tempo value of the output object. Defaults to use the
first element of <cite>tempo</cite>.</li>
<li><strong>constant_velocity</strong> (<em>int</em>) – The constant velocity to be assigned to binarized tracks. Defaults
to 100.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pm</strong> – The converted <code class="xref py py-class docutils literal"><span class="pre">pretty_midi.PrettyMIDI</span></code> instance.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>pretty_midi.PrettyMIDI</cite> object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.transpose">
<code class="descname">transpose</code><span class="sig-paren">(</span><em>semitone</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Transpose the pianorolls of all tracks by a number of semitones, where
positive values are for higher key, while negative values are for lower
key. The drum tracks are ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>semitone</strong> (<em>int</em>) – The number of semitones to transpose the pianorolls.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.trim_trailing_silence">
<code class="descname">trim_trailing_silence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.trim_trailing_silence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.trim_trailing_silence" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim the trailing silences of the pianorolls of all tracks. Trailing
silences are considered globally.</p>
</dd></dl>

<dl class="method">
<dt id="pypianoroll.Multitrack.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pypianoroll/multitrack.html#Multitrack.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pypianoroll.Multitrack.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the multitrack pianoroll to a MIDI file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – The name of the MIDI file to which the multitrack pianoroll is
written.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="track.html" class="btn btn-neutral" title="Single-track Piano-roll" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Hao-Wen Dong.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>